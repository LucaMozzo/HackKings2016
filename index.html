<html>
<head>
  <meta charset="utf-8">
  <script src="lib/three.js"></script>
  <script src="lib/leap-0.6.4.js"></script>
  <script src="lib/leap-plugins-0.1.11pre.js"></script>

  <script src="lib/leap-widgets-0.1.0.min.js"></script>

  <script src="lib/OrbitControls.js"></script>
  <script src="lib/audiosynth.js"></script>

</head>
<body>

</body>

<script>
  'use strict';

  // Set up plugins

  Leap.loop({background: true})
    .use('transform', {
      vr: 'desktop' // Switch to meters.
    })
    .use('boneHand', {
      targetEl: document.body,
      jointColor: new THREE.Color(0xffffff),
      rendererOps: {antialias: true}
    })
    .use('proximity');


  // Set up scene

  var scene = Leap.loopController.plugins.boneHand.scene;
  var camera = Leap.loopController.plugins.boneHand.camera;
  var renderer = Leap.loopController.plugins.boneHand.renderer;
  camera.position.set( 0.0, 0.5, 1.0 );

  var controls = new THREE.OrbitControls( camera );

  // Add a plane

  var keys = ['C', 'D', 'E', 'F', 'G', 'A', 'B', 'C']

  for (var i = -3; i < 4; i++) {
    createButton(0.05 * i, i, keys[i + 3], 0.04, 0.2, 0xffffff, 0.12);
  }

  createButton(-1 * 0.075, -2, keys[0] + '#', 0.04, 0.12, 0x000000, 0.15);
  createButton(-1.7 * 0.075, -2, keys[1] + '#', 0.04, 0.12, 0x000000, 0.15);
  createButton(0.33 * 0.075, -2, keys[3] + '#', 0.04, 0.12, 0x000000, 0.15);
  createButton(0.075, -2, keys[4] + '#', 0.04, 0.12, 0x000000, 0.15);
  createButton(1.7 * 0.075, -2, keys[5] + '#', 0.04, 0.12, 0x000000, 0.15);

  function createButton(pos, id, key, width, height, color, yPos) {

    var planeGeo = new THREE.PlaneGeometry(width, height);
    var material = new THREE.MeshPhongMaterial();
    var buttonMesh = new THREE.Mesh(planeGeo, material);

    buttonMesh.name = "rectangular button";

    material.color.setHex(color);

    var longThrow = -0.01;
    var squareButton = new PushButton(

      new InteractablePlane(buttonMesh, Leap.loopController),

      {
        locking: false,
        longThrow: longThrow
      }

    ).on('press', function(mesh){

      var piano = Synth.createInstrument('piano');
      piano.play(key, 4, 2); // piano stuff
      mesh.material.color.setHex(0xccccff);
      console.log(id)

    }).on('release', function(mesh){

      mesh.material.color.setHex(color);

    });

    squareButton.plane.hover(
      function(mesh){ // over
        mesh.material.color.setHex(0xffccff);
      },
      function(mesh){ // out
        mesh.material.color.setHex(color);
      }
    );


    var base = new THREE.Mesh(new THREE.BoxGeometry(0.04, longThrow, longThrow), new THREE.MeshPhongMaterial({color: 0x222222}));
    base.position.set(pos, yPos, -0.1);
    // base.position.set(0, 0.1, -0.2);
    base.rotateX(Math.PI * -0.5)
    // base.rotateY(Math.PI * 0.2);
    base.rotateZ(Math.PI);

    buttonMesh.position.set(
      0,
      buttonMesh.geometry.parameters.height / 2 - longThrow / 2,
      -longThrow / 2
    );
    squareButton.plane.resetPosition(); // resets the original position, etc to the current one

   // base.rotateX(Math.PI * -0.45);
   // base.position.set(0.2,0,0.2);

    base.add(buttonMesh);

    scene.add(base);
  }

  // createKey()

  // function createKey(key, octave) {
  //   var geometry = new THREE.BoxGeometry( 0.05, 0.10, 0.03 );
  //   var material = new THREE.MeshBasicMaterial( { color: 0xeff3f7 } );
  //   var cube = new THREE.Mesh( geometry, material );

  //   cube.position.set(0, 0.1, 0);
  //   cube.rotateX(Math.PI * -0.5)
  //   cube.rotateZ(Math.PI);

  //   scene.add( cube );
  // }


</script>

</html>